version: "3.6"

services:
  db:
    image: catalogqt/db
    environment:
      - MYSQL_RANDOM_ROOT_PASSWORD=1

  server:
    image: catalogqt/server
    depends_on:
      - db
    ports:
      - 8080:8080
      - 8443:8443

  updateprocess:
    image: catalogqt/updateprocess
    depends_on:
      - server

  watchdog:
    image: catalogqt/watchdog
    depends_on:
      - server

  react:
    image: registry.apps.man.poznan.pl/f4f/dashboard-ui/assets:branch-develop
    environment:
      - LISTEN_PORT=9100
      - S6_READ_ONLY_ROOT=1

# Docker compose doesn't like openVPN https://stackoverflow.com/a/56136591
networks:
  default:
    driver: bridge
    ipam:
      config:
        - subnet: 172.16.57.0/24